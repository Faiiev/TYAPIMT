# Теория языков программирования и методов трансляции

## Лабораторная работа №3. Построение лексического и синтаксического анализаторов для модельного паскалеподобного языка

Описание модельного M-языка:  
```
P → program D1; B#  
D1 → var D {,D}  
D → I {,I}: [ int | bool ]  
B → begin S {;S} end  
S → I := E | if E then S else S | while E do S | B | read (I) | write (E)  
E → E1 [ = | < | > | != ] E1 | E1  
E1 → T {[ + | - | or ] T}  
T → F {[ * | / | and ] F}  
F → I | N | L | not F | (E)  
L → true | false  
I → C | IC | IR  
N → R | NR  
C → a | b | ... | z | A | B | ... |Z  
R → 0 | 1 | 2 | ... | 9  
```

Все лексемы M-языка разделим на несколько классов:  
```
enum class LexemType {  
    NUMBER,     // число  
    DELIMITER,  // ограничитель  
    LANG_WORD,  // служебное слово  
    VAR_NAME    // идентификатор  
}  
```

## Лабораторная работа №4. Семантический анализ M-языка

Контекстно-свободные грамматики, с помощью которых описывают синтаксис языков программирования, не позволяют задавать контекстные условия, имеющиеся в любом языке.

> *Примеры наиболее часто встречающихся контекстных условий:*  
> 1. Каждый используемый в программе идентификатор должен быть описан, но не более одного раза в одной зоне описания;
> 2. При вызове функции число фактических параметров и их типы должны соответствовать числу и типам формальных параметров;
> 3. Обычно в языке накладываются ограничения на типы операндов любой операции, определенной в этом языке; на типы левой и правой частей в операторе присваивания; на тип параметра цикла; на тип условия в операторах цикла и условном операторе и т.п.

**Проверку контекстных условий часто называют семантическим анализом.**  
Его можно выполнять сразу после синтаксического анализа, некоторые требования можно контролировать во время генерации кода (например, ограничения на типы операндов в выражении), а можно совместить с синтаксическим анализом.  
Мы выберем последний вариант: как только синтаксический анализатор распознает конструкцию, на компоненты которой наложены некоторые ограничения, проверяется их выполнение. Это означает, что на этапе синтаксического анализа придется выполнять некоторые дополнительные действия, осуществляющие семантический контроль.  

**Контекстные условия, выполнение которых нам надо контролировать в программах на М-языке, таковы:**
1. Любое имя, используемое в программе, должно быть описано и только один раз.
2. В операторе присваивания типы переменной и выражения должны совпадать.
3. В условном операторе и в операторе цикла в качестве условия возможно только логическое выражение.
4. Операнды операции отношения должны быть целочисленными.
5. Тип выражения и совместимость типов операндов в выражении определяются по обычным правилам (как в Паскале).

Проверку контекстных условий совместим с синтаксическим анализом.  
Для этого в синтаксические правила вставим вызовы процедур, осуществляющих необходимый контроль, а затем перенесем их в процедуры рекурсивного спуска.

Для контроля согласованности типов в выражениях и типов выражений в операторах, необходимо знать типы переменных, входящих в эти выражения.  
Кроме того, нужно проверять, нет ли повторных описаний идентификаторов. Эта информация становится известной в тот момент, когда синтаксический анализатор обрабатывает описания.  
Следовательно, в синтаксические правила для описаний нужно вставить действия, с помощью которых будем запоминать типы переменных и контролировать единственность их описания.
